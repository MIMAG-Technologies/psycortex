<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Psycortex Pvt. Ltd. is dedicated to revolutionizing mental health care by providing innovative, accessible, and evidence-based solutions to enhance the well-being of individuals worldwide."
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://www.paynimo.com/paynimocheckout/client/lib/jquery.min.js"></script>
    <script
      src="https://www.paynimo.com/paynimocheckout/client/lib/jquery.min.js"
      type="text/javascript"
    ></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <title>Psycortex Pvt. Ltd</title>
  </head>
  <body>
    <div id="root"></div>

    <script
      type="text/javascript"
      src="https://www.paynimo.com/Paynimocheckout/server/lib/checkout.js"
    ></script>
    <script type="text/javascript">
      $(document).ready(function () {
        function hashData(algo, data) {
          const encoder = new TextEncoder();
          const dataBuffer = encoder.encode(data);

          return crypto.subtle.digest(algo, dataBuffer).then((hashBuffer) => {
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray
              .map((byte) => byte.toString(16).padStart(2, "0"))
              .join("");
          });
        }

        async function handleResponse(res) {
          if (
            typeof res != "undefined" &&
            typeof res.paymentMethod != "undefined" &&
            typeof res.paymentMethod.paymentTransaction != "undefined" &&
            typeof res.paymentMethod.paymentTransaction.statusCode !=
              "undefined" &&
            res.paymentMethod.paymentTransaction.statusCode == "0300"
          ) {
            alert("success");
            return false;
            // success code
          } else {
            alert("Error");
            return false;
            // error code
          }
        }

        async function getToken() {
          const algo = "SHA-512"; //sha256, sha512, md5
          const data =
            "T955031|TXN1140|4||c12345|9999999999|test@gmail.com||||||||||1025180466GPADTD";
          return await hashData(algo, data);
        }

        $(document)
          .off("click", "#btnSubmit")
          .on("click", "#btnSubmit", async function (e) {
            e.preventDefault();
            const token = await getToken();

            var configJson = {
              tarCall: false,
              features: {
                enableAbortResponse: true,
                enableExpressPay: true,
                enableInstrumentDeRegistration: true,
                enableMerTxnDetails: true,
              },
              consumerData: {
                deviceId: "WEBSH2", //possible values 'WEBSH1', 'WEBSH2' and 'WEBMD5'
                token: token,
                returnUrl: "https://psycortex.in/user/mycart",
                responseHandler: handleResponse,
                paymentMode: "all",
                merchantLogoUrl:
                  "https://psycortex.in/assets/Images/thebraintakeLogo.png", //provided merchant logo will be displayed
                merchantId: "T955031",
                consumerId: "c12345",
                consumerMobileNo: "9999999999",
                consumerEmailId: "test@gmail.com",
                txnId: "TXN1140", //Unique merchant transaction ID
                items: [
                  {
                    itemId: "first",
                    amount: "4",
                    comAmt: "0",
                  },
                ],
                customStyle: {
                  PRIMARY_COLOR_CODE: "#3977b7",
                  SECONDARY_COLOR_CODE: "#FFFFFF",
                  BUTTON_COLOR_CODE_1: "#1969bb",
                  BUTTON_COLOR_CODE_2: "#FFFFFF",
                },
              },
            };

            $.pnCheckout(configJson);
            if (configJson.features.enableNewWindowFlow) {
              pnCheckoutShared.openNewWindow();
            }
          });
      });
    </script>
  </body>
</html>
